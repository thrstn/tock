tock=window.tock||{},tock.storage={},tock.storage.init=function(){tock.storage.getItem("layout")||tock.storage.initDefaultLayout()},tock.storage.setItem=function(t,e){return"object"==typeof e&&(e=JSON.stringify(e)),localStorage.setItem(t,e)},tock.storage.getItem=function(t){var e=localStorage.getItem(t);try{e=JSON.parse(e)}catch(n){}return e},tock.storage.initDefaultLayout=function(){var t={entries:[{id:tock.generateId(),task:"All day",log:"You start this timer when you start working and leave it running all day.",running:!1,elapsed:0},{id:tock.generateId(),task:"Other",log:"Something else.",running:!1,elapsed:0},{id:tock.generateId(),task:"Launch",log:"When you grab some launch.",running:!1,elapsed:0}]};tock.storage.setItem("layout",t)},tock=window.tock||{},tock.timer={},tock.timer.init=function(){tock.timer.timeout=null,tock.timer.tick()},tock.timer.start=function(t){var e=$(t).parents(".entry");e.data("tock-timer-running")===!0?tock.timer.stop(t):(e.data("tock-timer-running",!0).data("tock-timer-start",Date.now()),tock.ui.timerButtonSwap(t))},tock.timer.stop=function(t){var e=$(t).parents(".entry");e.data("tock-timer-running")===!0&&(e.data("tock-timer-running",!1).data("tock-timer-start",null),tock.ui.timerButtonSwap(t))},tock.timer.tick=function(){tock.ui.updateElapsed(),tock.timer.timeout=setTimeout(tock.timer.tick,1e3)},tock=window.tock||{},tock.generateId=function(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)});return e},tock.init=function(){tock.storage.init(),tock.timer.init(),tock.ui.init()},tock=window.tock||{},tock.ui={},tock.ui.init=function(){tock.ui.bind(),tock.ui.renderLayout()},tock.ui.bind=function(){$("body").on("click",".btn-start-timer",function(t){t.preventDefault(),tock.timer.start(this)}).on("click",".btn-stop-timer",function(t){t.preventDefault(),tock.timer.stop(this)}).on("click",".btn-add-entry",function(t){t.preventDefault(),tock.ui.createEntry(),tock.ui.saveLayout()}).on("click",".btn-del-entry",function(t){t.preventDefault(),tock.ui.deleteEntry(this),tock.ui.saveLayout()}).on("focus","input[type=text]",function(){$(this).addClass("focused")}).on("blur","input[type=text]",function(){$(this).removeClass("focused"),tock.ui.saveLayout()}).on("keyup","input[type=text]",function(t){13==t.which&&$(this).trigger("blur")}).on("click",".btn-reset-layout",function(t){t.preventDefault(),tock.ui.resetLayout()})},tock.ui.renderLayout=function(){var t=tock.storage.getItem("layout");$(t.entries).each(function(t,e){var n=tock.ui.cloneTemplate().attr("id",e.id);n.find(".task input").val(e.task),n.find(".log input").val(e.log),e.elapsed&&n.data("tock-timer-elapsed",parseInt(e.elapsed)),e.running&&n.data("tock-timer-running",e.running),tock.ui.addEntry(n)})},tock.ui.saveLayout=function(){var t={entries:[]};$(".entry").each(function(){var e=$(this),n={id:e.attr("id"),task:e.find(".task input").val(),log:e.find(".log input").val(),running:e.data("tock-timer-running"),elapsed:e.data("tock-timer-elapsed")};t.entries.push(n)}),tock.storage.setItem("layout",t)},tock.ui.resetLayout=function(){tock.storage.initDefaultLayout(),tock.ui.refresh()},tock.ui.updateElapsed=function(){$(".entry").each(function(){var t=$(this);if(t.data("tock-timer-running")===!0){var e=t.data("tock-timer-start")/1e3,n=Date.now()/1e3,o=Math.ceil(n-e),i=Math.floor(o/3600),a=Math.floor(o%3600/60),r="";t.data("tock-timer-elapsed",o),i>0&&(r=i+"H "),r=r+a+"m",t.find(".elapsed").html(r)}})},tock.ui.timerButtonSwap=function(t){var e=$(t);e.hasClass("btn-start-timer")?e.removeClass("btn-start-timer btn-success").addClass("btn-stop-timer btn-danger").html("STOP"):e.removeClass("btn-stop-timer btn-danger").addClass("btn-start-timer btn-success").html("START")},tock.ui.cloneTemplate=function(){return tock.ui.getTemplateEntry().clone().removeClass("template hidden").addClass("entry")},tock.ui.createEntry=function(){tock.ui.addEntry(tock.ui.cloneTemplate())},tock.ui.addEntry=function(t){$(".controls","main").before(t)},tock.ui.deleteEntry=function(t){var e=$(t).parents(".entry");e.remove()},tock.ui.getTemplateEntry=function(){return $(".template")},tock.ui.refresh=function(){window.location=""};
//# sourceMappingURL=tock.min.js.map